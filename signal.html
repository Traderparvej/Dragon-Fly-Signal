<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DragonFly â€” Signal Generator</title>
<style>
:root{
  --bg:#081024;
  --panel:#0f1530;
  --muted:#9fb0d6;
  --text:#ffffff;
  --accent:#6dd6ff;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background:linear-gradient(180deg,#05102a,#081024);
  color:var(--text);
}
.wrap{max-width:1100px;margin:18px auto;padding:18px;}
header{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;}
header h1{margin:0;font-size:20px;display:flex;align-items:center;gap:12px;}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.03));border:1px solid rgba(255,255,255,0.04);border-radius:14px;padding:14px;margin-bottom:12px;}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;}
label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px;}
select,input[type=date],input[type=number],button{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.06);
  background:rgba(255,255,255,0.9);
  color:#000;
  font-weight:600;
}
.controls{display:flex;gap:10px;margin-top:12px;}
.controls button{flex:1;background:var(--accent);color:#000;border:none;border-radius:10px;cursor:pointer;font-weight:600;}
.output{
  margin-top:12px;
  padding:16px;
  border-radius:12px;
  background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(0,0,0,0.02));
  border:1px solid rgba(255,255,255,0.03);
  min-height:180px;
  white-space:pre-wrap;
  font-family:'Courier New', Courier, monospace;
  color:#fff;
  font-size:14px;
  line-height:1.45;
}
.unicode{font-family: "Arial", "DejaVu Sans", "monospace";}
footer{text-align:center;color:var(--muted);font-size:13px;margin-top:16px;}
a.owner-link{color:var(--accent);text-decoration:none;font-weight:bold;}
a.owner-link:hover{text-decoration:underline;}
@media (max-width:880px){.grid{grid-template-columns:1fr;}}

/* Asset Dropdown style tweak */
.select-inline {display:flex;gap:8px;align-items:center;}
.small-note{font-size:12px;color:var(--muted);}

/* ğŸ”’ Modal Style */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:999;}
.modal{background:#0f1530;padding:20px;border-radius:12px;width:90%;max-width:400px;color:#fff;box-shadow:0 8px 24px rgba(0,0,0,0.5);}
.modal h2{margin-top:0;margin-bottom:10px;}
.modal input{width:100%;padding:10px;border-radius:8px;border:1px solid #333;margin-bottom:12px;}
.modal button{padding:10px 16px;border:none;border-radius:8px;background:var(--accent);font-weight:bold;cursor:pointer;}
.modal .error{color:#ff8a8a;font-size:13px;display:none;margin-top:6px;}
.modal .expired a{color:#6dd6ff;text-decoration:none;}
.modal .expired a:hover{text-decoration:underline;}

/* Fancy separators for output */
.sep {color:var(--accent);font-weight:700;}
</style>
</head>
<body>
<div class="wrap">
<header>
<h1>ğŸ‰ DragonFly â€” Signal Generator
  <span id="licenseStatus" style="font-size:13px;color:#6dd6ff;font-weight:600;"></span>
</h1>
<div class="small">Software: DragonFly &nbsp; Owner: <a class="owner-link" href="https://t.me/TraderParvej" target="_blank">@TraderParvej</a></div>
</header>

<section class="card">
<div class="grid">
  <div>
    <label>UTC Offset (eg. +6:00)</label>
    <select id="utcSelect">
      <option value="+0:00">UTC +0:00</option>
      <option value="+6:00" selected>UTC +6:00 (BD)</option>
    </select>
  </div>

  <div>
    <label>Market</label>
    <select id="market">
      <option value="OTC">OTC</option>
      <option value="REAL">REAL</option>
    </select>
  </div>

  <div>
    <label>Timeframe</label>
    <select id="timeframe">
      <option value="1m" selected>1 minute</option>
      <option value="5m">5 minutes</option>
      <option value="15m">15 minutes</option>
      <option value="1h">1 hour</option>
    </select>
  </div>

  <!-- Removed Start Date and Signal Count as requested -->

  <div>
    <label>Select Asset</label>
    <div class="select-inline">
      <select id="assetSelect"></select>
    </div>
    <div class="small-note">à¦à¦•à¦¬à¦¾à¦°à§‡ à¦¶à§à¦§à§ à¦à¦•à¦Ÿà¦¿ à¦ªà§‡à§Ÿà¦¾à¦° à¦¸à¦¿à¦²à§‡à¦•à§à¦Ÿ à¦•à¦°à¦¾ à¦¯à¦¾à¦¬à§‡</div>
  </div>

  <div>
    <label>Bollinger Band</label>
    <select id="bollinger">
      <option value="upper" selected>Upper (Buy / CALL)</option>
      <option value="lower">Lower (Sell / PUT)</option>
    </select>
  </div>

  <div>
    <label>Signal Mode</label>
    <select id="modeSelect">
      <option value="auto" selected>Auto Analysis</option>
      <option value="manual">Manual</option>
    </select>
  </div>
</div>

<div class="controls">
  <button id="generate">Generate Signal</button>
  <button id="reset">Reset</button>
  <button id="copyOut">Copy Output</button>
</div>

<div class="output unicode" id="output">â–¶ï¸ DATE: â€” â—€ï¸

(Press Generate to produce signals)</div>
</section>

<footer>Â© DragonFly â€” Advance signals. Use responsibly.</footer>
</div>

<!-- ğŸ”’ License Modal -->
<div class="modal-backdrop" id="licenseModal" style="display:none;">
  <div class="modal">
    <h2>ğŸ”‘ License Required</h2>
    <div id="licenseContent">
      <p>Please enter your license key to unlock signals:</p>
      <input type="password" id="licenseKey" placeholder="Enter license key">
      <button id="submitLicense">Activate</button>
      <div class="error" id="licenseError">âŒ Invalid license, try again.</div>
      <p style="margin-top:10px;font-size:13px;">à¦²à¦¾à¦‡à¦¸à§‡à¦¨à§à¦¸ à¦¨à¦¿à¦¤à§‡ à¦Ÿà§‡à¦²à¦¿à¦—à§à¦°à¦¾à¦® à¦—à§à¦°à§à¦ªà§‡ à¦œà¦¯à¦¼à§‡à¦¨ à¦•à¦°à§à¦¨: <a href="https://t.me/+SsTMPgPVYoVlNTQ1" target="_blank">Click here</a></p>
    </div>
    <div class="expired" style="display:none;">
      <p>License Expired. Please contact for a new license:</p>
      <a href="https://t.me/+SsTMPgPVYoVlNTQ1" target="_blank">Contact via Telegram</a>
    </div>
  </div>
</div>

<script>
// ====== DOM Elements ======
const utcSel = document.getElementById('utcSelect');
const marketSel = document.getElementById('market');
const tf = document.getElementById('timeframe');
const assetSelect = document.getElementById('assetSelect');
const outDiv = document.getElementById('output');
const generateBtn = document.getElementById('generate');
const resetBtn = document.getElementById('reset');
const copyBtn = document.getElementById('copyOut');
const bollinger = document.getElementById('bollinger');
const modeSelect = document.getElementById('modeSelect');
const licenseStatus = document.getElementById('licenseStatus');

const licenseModal = document.getElementById('licenseModal');
const submitLicense = document.getElementById('submitLicense');
const licenseKey = document.getElementById('licenseKey');
const licenseError = document.getElementById('licenseError');
const licenseContent = document.getElementById('licenseContent');
const expiredContent = document.querySelector('.modal .expired');

let licenseOk = false;
const LICENSE_KEY = '63JA-TSGP-XMHD';
let licenseExpiry = localStorage.getItem('dragonfly_license_expiry') ? new Date(localStorage.getItem('dragonfly_license_expiry')) : null;

// ====== Pairs ======
const OTCpairs = [
"AUD/USD (OTC)","USD/BRL (OTC)","EUR/USD (OTC)","NZD/CAD (OTC)","USD/ARS (OTC)",
"AUD/CAD (OTC)","CAD/JPY (OTC)","USD/IDR (OTC)","EUR/GBP (OTC)","USD/BDT (OTC)",
"USD/PHP (OTC)","USD/EGP (OTC)","EUR/CHF (OTC)","EUR/AUD (OTC)","USD/ZAR (OTC)",
"AUD/CHF (OTC)","AUD/JPY (OTC)","CAD/CHF (OTC)","CHF/JPY (OTC)","EUR/CAD (OTC)",
"EUR/JPY (OTC)","GBP/AUD (OTC)","NZD/CHF (OTC)","USD/CAD (OTC)","USD/CHF (OTC)",
"USD/COP (OTC)","USD/INR (OTC)","USD/JPY (OTC)","USD/MXN (OTC)","USD/NGN (OTC)",
"USD/PKR (OTC)","AUD/NZD (OTC)","EUR/SGD (OTC)","GBP/JPY (OTC)","USD/TRY (OTC)",
"EUR/NZD (OTC)","GBP/NZD (OTC)","NZD/USD (OTC)","GBP/CHF (OTC)","GBP/CAD (OTC)","GBP/USD (OTC)"
];
const REALpairs = ['EUR/JPY','USD/JPY','CAD/JPY','NZD/USD','EUR/USD','GBP/USD','AUD/JPY','GBP/CAD','USD/CAD','AUD/CAD','AUD/USD','GBP/AUD','GBP/JPY','USD/CHF','EUR/GBP'];

// ====== Fill assetSelect based on market ======
function fillAssetSelect(){
  assetSelect.innerHTML = '';
  const pairs = marketSel.value === 'REAL' ? REALpairs : OTCpairs;
  pairs.forEach(pair=>{
    const opt = document.createElement('option');
    opt.value = pair;
    opt.textContent = pair;
    assetSelect.appendChild(opt);
  });
}
fillAssetSelect();
marketSel.addEventListener('change', fillAssetSelect);

// ====== Utilities ======
function pad2(n){ return String(n).padStart(2,'0'); }
function fmtDate(d){ return `${pad2(d.getDate())}.${pad2(d.getMonth()+1)}.${d.getFullYear()}`; }
function mono(str){
    const map = {
      "A":"ğ™°","B":"ğ™±","C":"ğ™²","D":"ğ™³","E":"ğ™´","F":"ğ™µ","G":"ğ™¶","H":"ğ™·","I":"ğ™¸","J":"ğ™¹",
      "K":"ğ™º","L":"ğ™»","M":"ğ™¼","N":"ğ™½","O":"ğ™¾","P":"ğ™¿","Q":"ğš€","R":"ğš","S":"ğš‚","T":"ğšƒ",
      "U":"ğš„","V":"ğš…","W":"ğš†","X":"ğš‡","Y":"ğšˆ","Z":"ğš‰",
      "0":"ğŸ¶","1":"ğŸ·","2":"ğŸ¸","3":"ğŸ¹","4":"ğŸº","5":"ğŸ»","6":"ğŸ¼","7":"ğŸ½","8":"ğŸ¾","9":"ğŸ¿",
      "-":"-","/":"/"," ":" "
    };
    return str.split("").map(ch=>map[ch.toUpperCase()]||ch).join("");
}

// ====== Build single signal ======
function buildSingleSignal(){
    const pair = assetSelect.value || 'EUR/USD';
    // Bollinger selection decides direction
    const band = bollinger.value; // 'upper' or 'lower'
    const strategy = band === 'upper' ? 'Bollinger Band (Upper)' : 'Bollinger Band (Lower)';
    const signal = band === 'upper' ? 'CALL (Buy)' : 'PUT (Sell)';

    // Entry time: exactly 1 minute from now (as requested)
    const now = new Date();
    const entry = new Date(now.getTime() + 1*60*1000);
    const timeStr = `${pad2(entry.getHours())}:${pad2(entry.getMinutes())}`;

    // Compose a professional analysis-like note (concise)
    const confidence = Math.floor(85 + Math.random()*15); // 85-99% pseudo-confidence for pro feel
    const reason = band === 'upper' 
      ? 'Price touching upper BB â€” momentum suggests short-term bullish continuation.' 
      : 'Price touching lower BB â€” momentum suggests short-term bearish continuation.';

    return {
      pair,
      timeStr,
      strategy,
      signal,
      confidence,
      reason,
      generatedAt: now
    };
}

// ====== Generate Output ======
function tfText(tfVal){
    if(tfVal.endsWith("m")) return tfVal.replace("m"," minutes");
    if(tfVal.endsWith("h")) return tfVal.replace("h"," hours");
    return tfVal;
}

function generateOutput(){
    const now=new Date().getTime();
    if(!licenseOk){
        licenseModal.style.display='flex'; return;
    }
    if(licenseExpiry && now>licenseExpiry){
        licenseOk = false;
        licenseExpiry = null;
        localStorage.removeItem('dragonfly_license_expiry');
        licenseStatus.textContent = "License Expired âŒ";
        licenseModal.style.display='flex';
        licenseContent.style.display='none';
        expiredContent.style.display='block';
        return;
    }

    outDiv.textContent="â³ Generating professional signal...";
    setTimeout(()=>{
        const sig = buildSingleSignal();
        const genDate = fmtDate(sig.generatedAt);
        const timeframeText = tfText(tf.value);

        // Professional DragonFly formatted output
        const lines = [];
        lines.push('âœ¦â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¦');
        lines.push('ğŸ”®  DRAGONFLY â€” AI MARKET ANALYSIS  ğŸ”®');
        lines.push('âœ¦â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¦\n');
        lines.push(`ğŸ“Š Pair        : ${sig.pair}`);
        lines.push(`â° Entry Time  : ${sig.timeStr}  (Exact â€” 1 minute from now)`);
        lines.push(`ğŸ“ˆ Timeframe   : ${timeframeText}`);
        lines.push(`âš™ï¸ Strategy    : ${sig.strategy}`);
        lines.push(`ğŸ¯ Signal      : ${sig.signal}`);
        lines.push(`ğŸ“ˆ Confidence : ${sig.confidence}%`);
        lines.push(`\nğŸ’¡ Reason      : ${sig.reason}`);
        lines.push(`\nğŸ•’ Generated   : ${genDate} | UTC ${utcSel.value}`);
        lines.push('\nâœ¦â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¦');
        lines.push('âš ï¸ Note: Signals are AI-assisted suggestions. Use risk management.');
        lines.push('âœ¦â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¦\n');
        lines.push('Software: DragonFly  â€¢  Owner: @TraderParvej');

        outDiv.textContent = lines.join('\n');
    },300);
}

// ====== License ======
function updateCountdown(){
    if(licenseOk && licenseExpiry){
        const now = new Date();
        let diff = licenseExpiry - now;
        if(diff <= 0){
            licenseOk = false;
            licenseExpiry = null;
            localStorage.removeItem('dragonfly_license_expiry');
            licenseStatus.textContent = "License Expired âŒ";
            return;
        }
        const days = Math.floor(diff/1000/60/60/24);
        const hrs = Math.floor(diff/1000/60/60)%24;
        const mins = Math.floor(diff/1000/60)%60;
        const secs = Math.floor(diff/1000)%60;
        licenseStatus.textContent = `License Active âœ… | Expires in ${days}d ${hrs}h ${mins}m ${secs}s`;
    } else if(!licenseOk){
        licenseStatus.textContent = "License Inactive âŒ";
    }
}
setInterval(updateCountdown,1000);

// ====== Check localStorage on load ======
if(localStorage.getItem('dragonfly_license_expiry')){
    const exp = new Date(localStorage.getItem('dragonfly_license_expiry'));
    if(exp.getTime() > new Date().getTime()){
        licenseExpiry = exp;
        licenseOk = true;
        licenseModal.style.display='none';
    } else {
        localStorage.removeItem('dragonfly_license_expiry');
    }
}
updateCountdown();

submitLicense.addEventListener('click',()=>{
    if(licenseKey.value.trim()===LICENSE_KEY){
        licenseOk=true;
        licenseExpiry=new Date().getTime()+30*24*60*60*1000;
        licenseExpiry = new Date(licenseExpiry);
        localStorage.setItem('dragonfly_license_expiry', licenseExpiry);
        licenseModal.style.display='none';
        licenseContent.style.display='block';
        expiredContent.style.display='none';
        updateCountdown();
        generateOutput();
    }else licenseError.style.display='block';
});

// ====== Buttons ======
generateBtn.addEventListener('click',generateOutput);
resetBtn.addEventListener('click',()=>{outDiv.textContent='â–¶ï¸ DATE: â€” â—€ï¸\n\n(Press Generate to produce signals)';});
copyBtn.addEventListener('click',()=>{navigator.clipboard.writeText(outDiv.textContent);copyBtn.textContent='Copied âœ”';setTimeout(()=>copyBtn.textContent='Copy Output',1000);});
</script>
</body>
</html>
