<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DragonFly ‚Äî Signal Generator</title>
<style>
:root{
  --bg:#081024;
  --panel:#0f1530;
  --muted:#9fb0d6;
  --text:#ffffff;
  --accent:#6dd6ff;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background:linear-gradient(180deg,#05102a,#081024);
  color:var(--text);
}
.wrap{max-width:1100px;margin:18px auto;padding:18px;}
header{display:flex;align-items:center;justify-content:space-between;gap:12px;}
header h1{margin:0;font-size:20px;}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.03));border:1px solid rgba(255,255,255,0.04);border-radius:14px;padding:14px;margin-bottom:12px;}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;}
label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px;}
select,input[type=date],input[type=number],button{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.06);
  background:rgba(255,255,255,0.9);
  color:#000;
  font-weight:600;
}
.controls{display:flex;gap:10px;margin-top:12px;}
.controls button{flex:1;background:var(--accent);color:#000;border:none;border-radius:10px;cursor:pointer;font-weight:600;}
.output{
  margin-top:12px;
  padding:12px;
  border-radius:12px;
  background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(0,0,0,0.02));
  border:1px solid rgba(255,255,255,0.03);
  min-height:180px;
  white-space:pre-wrap;
  font-family:'Courier New', Courier, monospace;
  color:#fff;
}
.unicode{font-family: "Arial", "DejaVu Sans", "monospace";}
footer{text-align:center;color:var(--muted);font-size:13px;margin-top:16px;}
a.owner-link{color:var(--accent);text-decoration:none;font-weight:bold;}
a.owner-link:hover{text-decoration:underline;}
@media (max-width:880px){.grid{grid-template-columns:1fr;}}

/* Asset Box Styles */
.asset-select-box {display:flex; flex-wrap:wrap; gap:8px; margin-top:6px;}
.asset-option {
  background:var(--panel);
  border:1px solid rgba(255,255,255,0.2);
  border-radius:8px;
  padding:8px 12px;
  cursor:pointer;
  user-select:none;
  transition:0.2s;
}
.asset-option.active {
  background:#10b98133;
  border-color:#10b981;
  color:#10b981;
  font-weight:600;
}

/* üîí Modal Style */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:999;}
.modal{background:#0f1530;padding:20px;border-radius:12px;width:90%;max-width:400px;color:#fff;box-shadow:0 8px 24px rgba(0,0,0,0.5);}
.modal h2{margin-top:0;margin-bottom:10px;}
.modal input{width:100%;padding:10px;border-radius:8px;border:1px solid #333;margin-bottom:12px;}
.modal button{padding:10px 16px;border:none;border-radius:8px;background:var(--accent);font-weight:bold;cursor:pointer;}
.modal .error{color:#ff8a8a;font-size:13px;display:none;margin-top:6px;}
.modal .expired a{color:#6dd6ff;text-decoration:none;}
.modal .expired a:hover{text-decoration:underline;}
.modal .license-info{margin-top:8px;font-size:13px;color:#6dd6ff;}
</style>
</head>
<body>
<div class="wrap">
<header>
<h1>üêâ DragonFly ‚Äî Signal Generator</h1>
<div class="small">Software: DragonFly &nbsp; Owner: <a class="owner-link" href="https://t.me/TraderParvej" target="_blank">@TraderParvej</a></div>
</header>

<section class="card">
<div class="grid">
<div>
<label>UTC Offset (eg. +6:00)</label>
<select id="utcSelect">
<option value="+0:00">UTC +0:00</option>
<option value="+6:00" selected>UTC +6:00 (BD)</option>
</select>
</div>
<div>
<label>Market</label>
<select id="market">
<option value="OTC">OTC</option>
<option value="REAL">REAL</option>
</select>
</div>
<div>
<label>Timeframe</label>
<select id="timeframe">
<option value="1m" selected>1 minute</option>
<option value="5m">5 minutes</option>
<option value="15m">15 minutes</option>
<option value="1h">1 hour</option>
</select>
</div>
<div>
<label>Start Date</label>
<input id="date" type="date">
</div>
<div>
<label>Signal Count</label>
<input type="number" id="count" min="1" value="8">
</div>
<div>
<label>Select Asset(s)</label>
<div class="asset-select-box" id="assetBox"></div>
</div>
<div>
<label>Signal Type</label>
<select id="signalType">
<option value="call">Call</option>
<option value="put">Put</option>
<option value="both" selected>Both</option>
</select>
</div>
</div>

<div class="controls">
<button id="generate">Generate</button>
<button id="reset">Reset</button>
<button id="copyOut">Copy Output</button>
</div>

<div class="output unicode" id="output">‚ñ∂Ô∏è DATE: ‚Äî ‚óÄÔ∏è

(Press Generate to produce signals)</div>

<p class="license-info" id="licenseStatus"></p>
</section>

<footer>¬© DragonFly ‚Äî Advance signals. Use responsibly.</footer>
</div>

<!-- üîí License Modal -->
<div class="modal-backdrop" id="licenseModal" style="display:none;">
  <div class="modal">
    <h2>üîë License Required</h2>
    <div id="licenseContent">
      <p>Please enter your license key to unlock signals:</p>
      <input type="password" id="licenseKey" placeholder="Enter license key">
      <button id="submitLicense">Activate</button>
      <div class="error" id="licenseError">‚ùå Invalid license, try again.</div>
      <p style="margin-top:10px;font-size:13px;">‡¶≤‡¶æ‡¶á‡¶∏‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡¶ø‡¶§‡ßá ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡ßá ‡¶ú‡¶Ø‡¶º‡ßá‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®: <a href="https://t.me/+SsTMPgPVYoVlNTQ1" target="_blank">Click here</a></p>
    </div>
    <div class="expired" style="display:none;">
      <p>License Expired. Please contact for a new license:</p>
      <a href="https://t.me/+SsTMPgPVYoVlNTQ1" target="_blank">Contact via Telegram</a>
    </div>
  </div>
</div>

<script>
// DOM Elements
const utcSel = document.getElementById('utcSelect');
const marketSel = document.getElementById('market');
const tf = document.getElementById('timeframe');
const dateInp = document.getElementById('date');
const countInp = document.getElementById('count');
const assetBox = document.getElementById('assetBox');
const outDiv = document.getElementById('output');
const generateBtn = document.getElementById('generate');
const resetBtn = document.getElementById('reset');
const copyBtn = document.getElementById('copyOut');
const signalType = document.getElementById('signalType');
const licenseStatus = document.getElementById('licenseStatus');

const licenseModal = document.getElementById('licenseModal');
const submitLicense = document.getElementById('submitLicense');
const licenseKey = document.getElementById('licenseKey');
const licenseError = document.getElementById('licenseError');
const licenseContent = document.getElementById('licenseContent');
const expiredContent = document.querySelector('.modal .expired');

let licenseOk = false;
const LICENSE_KEY = '63JA-TSGP-XMHD';
let licenseExpiry = localStorage.getItem('dragonfly_license_expiry') ? new Date(localStorage.getItem('dragonfly_license_expiry')) : null;

// Pairs
const OTCpairs = [
"AUD/USD (OTC)","USD/BRL (OTC)","EUR/USD (OTC)","NZD/CAD (OTC)","USD/ARS (OTC)",
"AUD/CAD (OTC)","CAD/JPY (OTC)","USD/IDR (OTC)","EUR/GBP (OTC)","USD/BDT (OTC)",
"USD/PHP (OTC)","USD/EGP (OTC)","EUR/CHF (OTC)","EUR/AUD (OTC)","USD/ZAR (OTC)",
"AUD/CHF (OTC)","AUD/JPY (OTC)","CAD/CHF (OTC)","CHF/JPY (OTC)","EUR/CAD (OTC)",
"EUR/JPY (OTC)","GBP/AUD (OTC)","NZD/CHF (OTC)","USD/CAD (OTC)","USD/CHF (OTC)",
"USD/COP (OTC)","USD/INR (OTC)","USD/JPY (OTC)","USD/MXN (OTC)","USD/NGN (OTC)",
"USD/PKR (OTC)","AUD/NZD (OTC)","EUR/SGD (OTC)","GBP/JPY (OTC)","USD/TRY (OTC)",
"EUR/NZD (OTC)","GBP/NZD (OTC)","NZD/USD (OTC)","GBP/CHF (OTC)","GBP/CAD (OTC)","GBP/USD (OTC)"
];

const REALpairs = ['EUR/JPY','USD/JPY','CAD/JPY','NZD/USD','EUR/USD','GBP/USD','AUD/JPY','GBP/CAD','USD/CAD','AUD/CAD','AUD/USD','GBP/AUD','GBP/JPY','USD/CHF','EUR/GBP'];

// Fill Asset Box
let activeAssets = [];
function fillAssetBox(){
    assetBox.innerHTML = '';
    const pairs = marketSel.value === 'REAL' ? REALpairs : OTCpairs;
    pairs.forEach(pair => {
        const div = document.createElement('div');
        div.className = 'asset-option';
        div.textContent = pair;
        div.addEventListener('click', () => {
            div.classList.toggle('active');
            if(div.classList.contains('active')){
                activeAssets.push(pair);
            }else{
                activeAssets = activeAssets.filter(a => a!==pair);
            }
        });
        assetBox.appendChild(div);
    });
}
fillAssetBox();
marketSel.addEventListener('change', ()=>{
    activeAssets = [];
    fillAssetBox();
});

// Utilities
function pad2(n){ return String(n).padStart(2,'0'); }
function fmtDate(d){ return `${pad2(d.getDate())}.${pad2(d.getMonth()+1)}.${d.getFullYear()}`; }
function mono(str){
    const map = {
      "A":"ùô∞","B":"ùô±","C":"ùô≤","D":"ùô≥","E":"ùô¥","F":"ùôµ","G":"ùô∂","H":"ùô∑","I":"ùô∏","J":"ùôπ",
      "K":"ùô∫","L":"ùôª","M":"ùôº","N":"ùôΩ","O":"ùôæ","P":"ùôø","Q":"ùöÄ","R":"ùöÅ","S":"ùöÇ","T":"ùöÉ",
      "U":"ùöÑ","V":"ùöÖ","W":"ùöÜ","X":"ùöá","Y":"ùöà","Z":"ùöâ",
      "0":"ùü∂","1":"ùü∑","2":"ùü∏","3":"ùüπ","4":"ùü∫","5":"ùüª","6":"ùüº","7":"ùüΩ","8":"ùüæ","9":"ùüø",
      "-":"-","/":"/"," ":" "
    };
    return str.split("").map(ch=>map[ch.toUpperCase()]||ch).join("");
}

// Generate Direction
function randDir(){
    const type = signalType.value;
    if(type === 'call') return 'ùô≤ùô∞ùôª';
    if(type === 'put') return 'ùôøùöÑùöÉ';
    return Math.random() > 0.5 ? 'ùô≤ùô∞ùôª' : 'ùôøùöÑùöÉ';
}

// Build Signals
function buildSignals(count){
    if(activeAssets.length===0) activeAssets = ['USD/JPY'];
    const out=[];
    let cursor=new Date();
    let lastPair = null;
    for(let i=0;i<count;i++){
        cursor=new Date(cursor.getTime()+(2+Math.floor(Math.random()*4))*60000);
        const time = `${pad2(cursor.getHours())}:${pad2(cursor.getMinutes())}`;
        
        let pair;
        if(activeAssets.length===1){
            pair = activeAssets[0];
        } else {
            let attempts = 0;
            do {
                pair = activeAssets[Math.floor(Math.random()*activeAssets.length)];
                attempts++;
            } while(pair === lastPair && attempts < 10);
        }
        lastPair = pair;

        let pairFmt = pair.toUpperCase().replace("/","").replace(" ","").replace("(OTC)","-OTC");
        out.push(`${mono("M1")} ${mono(pairFmt)} ${mono(time)} ${randDir()}`);
    }
    return out;
}

// Generate Output
function tfText(tfVal){
    if(tfVal.endsWith("m")) return tfVal.replace("m"," minutes");
    if(tfVal.endsWith("h")) return tfVal.replace("h"," hours");
    return tfVal;
}

function generateOutput(){
    const now=new Date().getTime();
    if(!licenseOk){
        licenseModal.style.display='flex'; return;
    }
    if(licenseExpiry && now>licenseExpiry.getTime()){
        licenseContent.style.display='none';
        expiredContent.style.display='block';
        licenseModal.style.display='flex';
        return;
    }
    outDiv.textContent="‚è≥ Generating... (1s)";
    setTimeout(()=>{
        const dateStr=dateInp.value?fmtDate(new Date(dateInp.value)):fmtDate(new Date());
        const count=Number(countInp.value||8);
        const signals=buildSignals(count);

        let lines=[];
        lines.push(`DATE: ${dateStr}\n`);
        lines.push(`‚è∞ UTC ${utcSel.value} ;  MTG :- 1 STEP\n`);
        lines.push(`              üêâDragonFly üêâ\n`);
        lines.push(`‚åõÔ∏è ${tfText(tf.value)} :- \n`);
        lines.push(signals.join("\n"));
        lines.push(`\nSoftware:DragonFly\nOwner: @TraderParvej`);
        outDiv.textContent=lines.join('\n');
    },500);
}

// Countdown Timer
function updateCountdown(){
    if(licenseOk && licenseExpiry){
        const now=new Date();
        let diff = licenseExpiry - now;
        if(diff<=0){
            licenseStatus.textContent="License Expired ‚ùå";
            licenseOk=false;
            return;
        }
        const days = Math.floor(diff/1000/60/60/24);
        const hrs = Math.floor(diff/1000/60/60)%24;
        const mins = Math.floor(diff/1000/60)%60;
        const secs = Math.floor(diff/1000)%60;
        licenseStatus.textContent = `License Active ‚úÖ | Expires in ${days}d ${hrs}h ${mins}m ${secs}s`;
    }
}
setInterval(updateCountdown,1000);

// License Submit
submitLicense.addEventListener('click',()=>{
    if(licenseKey.value.trim()===LICENSE_KEY){
        licenseOk=true;
        const expiry = new Date();
        expiry.setDate(expiry.getDate()+30);
        licenseExpiry=expiry;
        localStorage.setItem('dragonfly_license_expiry',expiry.toISOString());
        licenseModal.style.display='none';
        licenseContent.style.display='block';
        expiredContent.style.display='none';
        generateOutput();
        updateCountdown();
    } else {
        licenseError.style.display='block';
    }
});

// Check localStorage on load
window.addEventListener('load',()=>{
    if(licenseExpiry && new Date() < licenseExpiry){
        licenseOk=true;
        updateCountdown();
    } else if(licenseExpiry && new Date() >= licenseExpiry){
        licenseOk=false;
        licenseExpiry=null;
        localStorage.removeItem('dragonfly_license_expiry');
        licenseStatus.textContent="License Expired ‚ùå";
    } else {
        licenseModal.style.display='flex';
    }
});

// Buttons
generateBtn.addEventListener('click',generateOutput);
resetBtn.addEventListener('click',()=>{outDiv.textContent='‚ñ∂Ô∏è DATE: ‚Äî ‚óÄÔ∏è\n\n(Press Generate to produce signals)';});
copyBtn.addEventListener('click',()=>{navigator.clipboard.writeText(outDiv.textContent);copyBtn.textContent='Copied ‚úî';setTimeout(()=>copyBtn.textContent='Copy Output',1000);});
</script>
</body>
</html>
