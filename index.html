for(let i=0;i<numSignals;i++){
   const asset=selectedAssets[i%selectedAssets.length];
   const gap=Math.floor(Math.random() * 3) + 2;
   now.setMinutes(now.getMinutes()+gap);
   const timeStr=pad2(now.getHours())+":"+pad2(now.getMinutes());
   const monoTime=toMono(timeStr);
   const monoAsset=toMono(asset.toUpperCase());
   let sideLabel="";

   if(mode==="CALL") sideLabel="CALL";
   else if(mode==="PUT") sideLabel="PUT";
   else if(mode==="BOTH") sideLabel = signalSides[i];

   if(mode==="OPPOSITE"){
     msg+=ð™¼ðŸ· ${monoTime} ${monoAsset}\n;
   }else{
     const monoSide=toMono(" "+sideLabel);
     msg+=ð™¼ðŸ· ${monoTime} ${monoAsset}${monoSide}\n;
   }
 }
 msg+="\nâ—ï¸ Avoid signal after Doji, <80%, Gap, or 3â€“4 B2B opposite candles";
 signalText.textContent=msg;
 signalModal.style.display='flex';
}

resetBtn.addEventListener('click',()=>{assetContainer.querySelectorAll('input').forEach(c=>c.checked=false);});
copySignalBtn.addEventListener('click',()=>{navigator.clipboard.writeText(signalText.textContent);alert("Copied!");});
function closeSignal(){signalModal.style.display='none';}

generateBtn.addEventListener('click',()=>{
  if(!loadLicenseLocal()){ alert("âŒ License required."); return; }
  analysisOverlay.style.display='flex';
  setTimeout(()=>{
    analysisOverlay.style.display='none';
    showSignal();
  }, 10000);
});

function showLoginPopup(){ loginPopup.style.display='flex'; }
function closeLoginPopup(){ loginPopup.style.display='none'; }
</script>
</body>
</html>
